<VirtualHost *:80>
   ServerName {{ artifacts_hostname }}
   Redirect permanent / https://{{ artifacts_hostname }}/
</VirtualHost>

<VirtualHost *:443>
  SSLEngine on
  SSLCertificateFile {{ ssl_certs_cert_path }}
  SSLCertificateKeyFile {{ ssl_certs_privkey_path }}

  ServerName {{ artifacts_hostname }}
  ServerAdmin {{ admin_email }}

  ProxyPass / {{ nexus_private_base_url }}/
  ProxyPassReverse / {{ nexus_private_base_url }}/

  RequestHeader set X-Forwarded-Proto "https"

  ErrorLog {{ artifacts_apache_logs_dir }}/error.log
  CustomLog {{ artifacts_apache_logs_dir }}/access.log common
</VirtualHost>


<VirtualHost *:80>
   ServerName {{ docs_hostname }}
   Redirect permanent / https://{{ docs_hostname }}/
</VirtualHost>

<VirtualHost *:443>
  SSLEngine on
  SSLCertificateFile {{ ssl_certs_cert_path }}
  SSLCertificateKeyFile {{ ssl_certs_privkey_path }}

  ServerName {{ docs_hostname }}
  ServerAdmin {{ admin_email }}

  ProxyPass / {{ nexus_private_base_url }}/repository/{{ nexus_repos_raw_hosted[0].name }}/
  ProxyPassReverse / {{ nexus_private_base_url }}/repository/{{ nexus_repos_raw_hosted[0].name }}/

  RequestHeader set X-Forwarded-Proto "https"

  ErrorLog {{ docs_apache_logs_dir }}/error.log
  CustomLog {{ docs_apache_logs_dir }}/access.log common
</VirtualHost>
